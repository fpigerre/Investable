<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="responsive-container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target="#navbar-main">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <%= image_tag('blue-placeholder.jpg', class: 'logo') %>
      <p class="username">
        <%= current_user.name %>
      </p>
      <%= link_to 'Stockable', user_root_path, class: 'brand' %>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="navbar-main">
      <ul class="nav navbar-nav links">
        <li class="active"><%= link_to 'Home', user_root_path %></li>
        <li><%= link_to 'Comparison', comparison_path %></li>
        <li><%= link_to 'Markets', markets_path %></li>
        <li><%= link_to 'BitCoin', bitcoin_path %></li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <%= form_tag(search_path, :method => 'get', class: 'navbar-form navbar-left', role: 'search') do %>
            <div class="form-group">
              <%= text_field_tag :search, params[:search], placeholder: 'Find a stock', class: 'form-control rounded-corners', type: 'text', id: 'search' %>
            </div>
        <% end %>
        <li class="nav-icon"><%= link_to '', edit_user_registration_path, class: 'glyphicon glyphicon-wrench' %></li>
        <li class="nav-icon"><%= link_to('', destroy_user_session_path, :method => :delete, class: 'glyphicon glyphicon-log-out') %></li>
      </ul>
    </div>
  </div>
</nav>

<div class="status">
  <h1><%= @data[0].name.gsub('"', '') %></h1>

  <div class="status-right top">
    <small>Last Trade Price</small>
    <% if @data[0].last_trade_price == 'N/A' %>
        <h4>Not Currently Trading</h4>
    <% else %>
        <h4>$ <%= @data[0].last_trade_price %>
          <% if @data[0].change.include? '+' %>
              <small style="color: #009933;">
          <% else %>
              <small style="color: #D14836;">
          <% end %>
          <%= @data[0].change %></small></h4>
    <% end %>
  </div>
</div>
<div class="graph-wrap">
  <div id="graphdiv"></div>
</div>
<div class="content-header">
  <h3>Stock Information</h3>

  <div class="status-right top">
    <%= follow_link($stock) %>
  </div>
</div>
<div class="content grey container-fluid">
  <div class="row">
    <div class="rounded-container left">
      <h3>Latest Ask</h3>
      <h5 class="status-right"><%= @data[0].ask %></h5>
    </div>
    <div class="rounded-container left">
      <h3>Latest Bid</h3>
      <h5 class="status-right"><%= @data[0].bid %></h5>
    </div>
    <div class="rounded-container right">
      <h3>Open</h3>
      <h5 class="status-right"><%= @data[0].open %></h5>
    </div>
    <div class="rounded-container right no-margin">
      <h3>Close</h3>
      <h5 class="status-right"><%= @data[0].close %></h5>
    </div>
  </div>
  <div class="row">
    <div class="rounded-container left">
      <h3>Volume</h3>
      <h5 class="status-right"><%= number_with_delimiter(@data[0].volume, :delimiter => ',') %></h5>
    </div>
    <div class="rounded-container left">
      <h3>Dividend Yield</h3>
      <h5 class="status-right"><%= @data[0].dividend_yield %></h5>
    </div>
    <div class="rounded-container right">
      <h3>Market Cap</h3>
      <h5 class="status-right"><%= @data[0].market_capitalization %></h5>
    </div>
    <div class="rounded-container right no-margin">
      <h3>Change</h3>
      <h5 class="status-right"><%= @data[0].change_in_percent %></h5>
    </div>
  </div>
</div>
<div class="content container-fluid">

</div>

<script type="text/javascript">
    var array = <%= raw @input.to_s.gsub('(', '("').gsub(')"', '")').gsub('["', '[') %>
            graph = new Dygraph(document.getElementById("graphdiv"), array.reduce(function (a, b) {
                return "" + a + "\n" + b;
            }), {
                labels: ['Year', 'High', 'Low'],
                colors: ["#D5D5D5", "#A5A5A5"],
                axisLineColor: 'white',
                axisLabelColor: 'white'
            });
</script>